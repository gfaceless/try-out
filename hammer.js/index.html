<html>

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
    <style>
    html,
    body {
        padding: 0;
        margin: 0;
        width: 100%;
        height: 100%;
    }
    
    .container {
        width: 100%;
        height: 100%;
        background-color: #ccc;
        overflow: hidden;
        position: relative;
        /* position: absolute;
        top: 0;
        overflow: hidden; */
    }
    
    .slide {
        position: absolute;
    }
    
    .page1 {
        width: 100%;
        height: 100%;
        background-color: orange;
    }
    
    .page2 {
        /*margin-top: 30px;*/
        
        background-color: cyan;
        width: 100%;
        height: 100%;
        /*overflow: scroll;*/
    }
    
    .animate > .slide {
        transition: all .3s;
        -webkit-transition: all .3s;
    }
    </style>
</head>

<body>
    <div class="container">
        <div class="page1 slide"></div>
        <div class="page2 slide">
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Maxime dolor sunt impedit voluptatum dignissimos voluptate distinctio pariatur voluptates, asperiores at, minima mollitia doloribus commodi ullam temporibus qui nobis dolore architecto necessitatibus nisi obcaecati ducimus. Delectus explicabo earum animi, officia sed voluptatem. Veritatis aspernatur, asperiores ipsa distinctio neque, assumenda odit eveniet tempora soluta voluptatibus sunt, facere natus vel sit molestias temporibus earum deserunt voluptate ducimus mollitia minima repudiandae quia est laborum. Eligendi porro tempore animi quam sunt aspernatur soluta veritatis, ratione maxime quidem minima vitae aut iste facilis aliquam. Labore in facilis similique aperiam, illo voluptas libero. Cumque quos tempore nulla, nisi ut dolore, in quo voluptas vel, id nihil impedit cum amet unde placeat aperiam voluptatem blanditiis quibusdam repudiandae quam. Dolore fugiat doloribus sequi quae magnam iure, minus, qui deleniti expedita labore praesentium nulla ratione cum quia quaerat consequatur harum optio. Aliquam debitis natus libero officiis vitae, cum veniam laboriosam, nesciunt corporis hic atque expedita praesentium vel, iure a excepturi deserunt ea eos. Illo harum assumenda laboriosam veritatis nesciunt nihil quaerat ipsa! Fugit beatae quidem dolore adipisci, voluptates alias voluptatibus ipsa vitae illum provident voluptate, eos aliquid repellat ratione vel rem saepe consectetur, quasi ipsam aspernatur dicta, nisi blanditiis laborum minus sapiente. Ut voluptate repellat quis eaque. Earum officiis velit at, quidem, laborum pariatur, vitae, dolor repudiandae aliquam natus a consectetur tempora aspernatur hic doloremque! Consequatur quos maiores quod veritatis dignissimos nihil aut a atque, iste enim ratione ipsa saepe. Voluptatibus tenetur eligendi amet fugit libero dolorem quam illo nulla maxime minus totam laboriosam dicta exercitationem omnis nihil, harum, illum dolore ipsa ratione, quas atque impedit. Soluta laborum cumque qui in, neque placeat, beatae tenetur possimus, minima esse eius fugit quaerat architecto nostrum cum molestias sint? Asperiores iusto praesentium quidem temporibus dolores quod ab nemo culpa, eveniet saepe amet quae, ipsa quis tenetur, soluta qui placeat veritatis consequatur odit illo optio mollitia maxime. Neque id ipsam blanditiis, corrupti ea! Possimus accusamus libero id sed, iste rerum maiores, numquam quae iusto ipsum a nisi aliquam. Impedit perferendis dolorem, expedita, dignissimos unde, cum a, non vitae at eius labore. Ex debitis asperiores, quam autem impedit architecto consectetur soluta sunt. Deleniti alias ullam quos culpa optio doloremque, praesentium iste ut, vitae nisi repudiandae voluptate eveniet expedita, esse cumque error. Corporis nisi quae saepe voluptatibus, ad! At ea ullam iure, exercitationem, quae quod! Sint, cupiditate, obcaecati. Eius adipisci doloribus a suscipit mollitia iusto saepe ducimus error sunt non sequi, inventore quaerat officia, accusantium debitis repudiandae voluptatem. Esse rem molestiae, tempore culpa animi, ad dicta accusamus suscipit, quisquam reprehenderit aliquam. Dicta perspiciatis necessitatibus ad adipisci, eveniet quos magnam, laboriosam at fuga laudantium distinctio excepturi libero magni laborum eligendi nam impedit deserunt blanditiis. Dolores beatae voluptatibus optio quidem rem odio iste culpa ratione voluptatem enim consectetur nesciunt assumenda atque quam eligendi eveniet qui saepe, eum illum. Qui nostrum rerum eum unde iste a praesentium quaerat nulla cum autem reiciendis voluptas et veniam, impedit voluptatum incidunt eveniet obcaecati fugiat fugit asperiores. Iste voluptas ea asperiores repudiandae ratione voluptatem, quo quia delectus! Eius deleniti iste illo natus dolores corporis atque non obcaecati a velit tempora aspernatur iure harum in optio officiis fugiat mollitia, officia nihil aliquid maxime blanditiis consequuntur earum deserunt veritatis? Vel suscipit molestiae provident ducimus nesciunt voluptas omnis ut magni facilis est quod officiis, dicta consequuntur quo modi a accusamus. Eius vero quis nihil ad neque accusantium nulla doloribus odio odit veritatis porro in culpa assumenda nesciunt expedita at laborum sequi voluptate tempore error ullam, quas possimus omnis esse? Mollitia voluptatibus neque, dignissimos officiis! Rem magni ipsam voluptatibus eligendi animi modi dolor quod recusandae facere tempore praesentium adipisci culpa repellendus doloribus laborum consectetur deleniti nostrum quas ullam dicta nemo saepe, officiis temporibus. Dicta pariatur itaque nobis velit voluptatem, necessitatibus ullam sunt quo possimus quos facilis quibusdam aliquam molestiae minus odio fugit voluptatibus ipsum deserunt, omnis amet. Quidem inventore iusto aliquid earum quibusdam fuga dolorum similique voluptatem, accusamus neque excepturi, praesentium beatae, numquam. Fugiat repellendus ipsum doloribus sapiente eligendi exercitationem vel mollitia iusto aliquid corporis dolor, sed quod? Veniam laborum, fuga corporis deleniti est mollitia blanditiis sit placeat repellendus suscipit. Laborum dolorum, laboriosam odit minima ipsa ut labore, tenetur cumque autem molestias cum excepturi maxime. Fugiat molestias, facere nostrum ipsam! Amet quibusdam dicta ad, impedit maiores blanditiis perspiciatis! Dolor, numquam labore esse dolorum autem ad sapiente at voluptate. Saepe nulla odio minus obcaecati pariatur officiis molestias, eveniet harum laudantium sed optio iste quisquam voluptatem dolorum alias. Praesentium delectus inventore, accusamus veniam quod eaque cupiditate iste odit veritatis perspiciatis unde aliquam, nam voluptas placeat laboriosam itaque reprehenderit quaerat alias recusandae ipsam fuga. Perferendis nemo quae laborum sequi impedit. Saepe et, quibusdam dignissimos pariatur, minus officia eaque a. Ut totam ea odio beatae mollitia tenetur illum unde eligendi perspiciatis itaque impedit nisi voluptatum, quos iure dolorum corporis quibusdam libero nihil? Voluptatibus possimus accusamus, debitis fuga harum sed quas minima itaque tempore? Quis cumque dolores expedita consequuntur a veniam tempora quia fuga, unde, ipsam, corrupti, corporis deserunt ipsum quae quaerat. Officiis nulla consequatur architecto consectetur nobis soluta error similique, odio numquam culpa aperiam impedit, voluptate, maiores dolores delectus autem, ratione enim aliquam. Quo ratione cupiditate illo architecto est voluptatibus officiis aliquam numquam error minima asperiores, voluptatum reiciendis tenetur at assumenda veritatis, praesentium a id nesciunt aspernatur nostrum, maxime perspiciatis placeat molestias, excepturi? Nisi tempore illum eligendi totam molestias. Laudantium error corporis veritatis quisquam quibusdam ipsam dignissimos odio, reprehenderit, voluptatem distinctio ex, eaque quaerat voluptas debitis natus suscipit. Ducimus aut explicabo, cupiditate excepturi, a fugiat nemo tenetur consectetur dolorem eveniet rem doloremque corporis itaque est laborum, eos odio, magnam aperiam culpa maiores assumenda suscipit quod quia! Veniam, nesciunt non adipisci consequatur laboriosam dolor, nobis officia a eligendi fugiat eaque accusantium quasi ipsum quos voluptate accusamus mollitia repellendus nisi saepe ipsam impedit excepturi molestiae? Corporis, ipsum, vel! Numquam soluta, fugiat cumque, debitis, animi laborum adipisci doloribus harum itaque maxime error explicabo. Nisi, laboriosam consequuntur, quisquam ea quia quidem eligendi dolorum sequi amet illo obcaecati quaerat quas pariatur eveniet praesentium accusantium, accusamus quos.</p>
        </div>
    </div>
</body>
<script src="hammer.js"></script>
<script src="jquery-1.11.2.js"></script>
<script src="iscroll.js"></script>
<script>
var reqAnimationFrame = (function() {
    return window[Hammer.prefixed(window, "requestAnimationFrame")] || function(callback) {
        setTimeout(callback, 1000 / 60);
    }
})();

function dirProp(direction, hProp, vProp) {
    return (direction & Hammer.DIRECTION_HORIZONTAL) ? hProp : vProp
}


/**
 * Carousel
 * @param container
 * @param direction
 * @constructor
 */
function HammerCarousel(container, direction) {
    this.container = container;
    this.direction = direction;

    this.panes = Array.prototype.slice.call(this.container.children, 0);
    this.containerSize = this.container[dirProp(direction, 'offsetWidth', 'offsetHeight')];

    this.currentIndex = 0;

    this.hammer = new Hammer.Manager(this.container);
    this.hammer.add(new Hammer.Pan({
        direction: this.direction,
        threshold: 10
    }));
    this.hammer.on("panstart panmove panend pancancel", Hammer.bindFn(this.onPan, this));

    this.show(this.currentIndex);
}


HammerCarousel.prototype = {
    /**
     * show a pane
     * @param {Number} showIndex
     * @param {Number} [percent] percentage visible
     * @param {Boolean} [animate]
     */
    show: function(showIndex, percent, animate) {
        showIndex = Math.max(0, Math.min(showIndex, this.panes.length - 1));
        percent = percent || 0;

        var className = this.container.className;
        if (animate) {
            if (className.indexOf('animate') === -1) {
                this.container.className += ' animate';
            }
        } else {
            if (className.indexOf('animate') !== -1) {
                this.container.className = className.replace('animate', '').trim();
            }
        }

        var paneIndex, pos, translate;
        for (paneIndex = 0; paneIndex < this.panes.length; paneIndex++) {
            pos = (this.containerSize / 100) * (((paneIndex - showIndex) * 100) + percent);
            if (this.direction & Hammer.DIRECTION_HORIZONTAL) {
                translate = 'translate3d(' + pos + 'px, 0, 0)';
            } else {
                translate = 'translate3d(0, ' + pos + 'px, 0)'
            }
            this.panes[paneIndex].style.transform = translate;
            this.panes[paneIndex].style.mozTransform = translate;
            this.panes[paneIndex].style.webkitTransform = translate;
        }

        this.currentIndex = showIndex;
    },

    /**
     * handle pan
     * @param {Object} ev
     */
    onPan: function(ev) {
        console.log(ev.type);
        var pauseHammer;
        if(ev.type == 'panend') {
            this.inTransition = false;
            // very lite, just a prop changed
            myScroll.enable();
        }
        if (this.currentIndex === 1) {
            pauseHammer = true;
            console.log(myScroll.y);
            if( myScroll.y === 0 && ev.direction === Hammer.DIRECTION_DOWN){
                myScroll.disable();
                if(ev.type == "panstart") {this.inTransition = true;}
                pauseHammer = false;
            }
            if( ev.direction == Hammer.DIRECTION_UP && this.inTransition){
                pauseHammer = false;
            }
            /*if (!( myScroll.y = 0 && ev.direction === Hammer.DIRECTION_DOWN)) {
                return;
            }*/
        }

        if(pauseHammer) return;
        ev.preventDefault();
        var delta = dirProp(this.direction, ev.deltaX, ev.deltaY);
        var percent = (100 / this.containerSize) * delta;
        var animate = false;

        if (ev.type == 'panend' || ev.type == 'pancancel') {
            if (Math.abs(percent) > 20 && ev.type == 'panend') {
                this.currentIndex += (percent < 0) ? 1 : -1;
            }
            percent = 0;
            animate = true;
        }


        this.show(this.currentIndex, percent, animate);
    }
};

// the horizontal pane scroller
var outer = new HammerCarousel(document.querySelector(".container"), Hammer.DIRECTION_VERTICAL);
var scrollTop;
var page2 = document.querySelector('.page2')

$(function() {
    myScroll = new IScroll('.page2', {
        scrollX: false,
        scrollY: true,
        momentum: true,   
        bounce: false 
    });    
    myScroll.on('beforeScrollStart', function(e, a,b) {console.log(e,a,b)})
})
</script>

</html>
